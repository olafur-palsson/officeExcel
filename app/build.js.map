{"version":3,"sources":["../appES6/buildES5.js"],"names":[],"mappings":"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","file":"build.js","sourcesContent":["define((require) => {\r\n  const $db   = require(\"database\")\r\n  const $make = require(\"make\")\r\n  const $dm   = require(\"dataManager\")\r\n\r\n\r\n  const renderAvailability = (availabilities) => {\r\n\r\n    const table           = getAvailabilityTable(availabilities)\r\n    const availabilityDiv = document.querySelector(\".channelAvailability\")\r\n    availabilityDiv.appendChild(table)\r\n  }\r\n\r\n  const tableFromArray = (table, headers) => {\r\n    $make.tableFromArray(table, headers)\r\n  }\r\n\r\n\r\n  const renderRates = (rates) => {\r\n\r\n    const tableHeaders = [\"date\", \"rates\", \"availbilities\"]\r\n    const rateTable    = $make.tableFromArray(rates, tableHeaders)\r\n    const rateDiv      = document.querySelector(\".rates\")\r\n    rateDiv.appendChild(rateTable)\r\n  }\r\n\r\n\r\n  const getAvailabilityTable = (availabilities) => {\r\n\r\n    const array = $dm.availabilityToTableFormat(availabilities)\r\n    return $make.tableFromArray(array)\r\n  }\r\n\r\n\r\n  const appendInput = (div, text, inputType, inputName, defaultValue) => {\r\n\r\n    const input    = $make.input(inputType, defaultValue, null)\r\n    const br       = $make.el(\"br\")\r\n    const textNode = $make.txt(text)\r\n\r\n    div.appendChild(textNode)\r\n    div.appendChild(input)\r\n    div.appendChild(br)\r\n  }\r\n\r\n\r\n  const createSubForm = (index, roomTypes) => {\r\n\r\n    const superDiv   = $make.el(\"div\")\r\n    superDiv.setAttribute(\"class\", \"groupBooking booking\" + index)\r\n    appendInput(superDiv, \"date for booking \" + index, \"date\", \"date\" + index, \"2018-1-1\")\r\n    appendInput(superDiv, \"nights for booking \" + index, \"number\", \"nights\" + index, 1)\r\n    \r\n    for(let key in roomTypes) {\r\n      appendInput(\r\n        superDiv, \r\n        \"number of \" + roomTypes[key] + \" rooms\",\r\n        \"number\",\r\n        key + index,\r\n        1)\r\n    }\r\n\r\n    return superDiv\r\n  }\r\n\r\n\r\n  const createForm = (numberOfSubforms, roomTypes) => {\r\n\r\n    const form = $make.el(\"form\")\r\n    form.setAttribute(\"class\", \"groupCalc__form\")\r\n    for(let i = 1; i <= numberOfSubforms; i++) {\r\n      const div = createSubForm(i, roomTypes)\r\n      div.setAttribute(\"class\", \"groupCalc__booking\" + i)\r\n      form.appendChild(div)\r\n    }\r\n    return form\r\n  }\r\n\r\n  const renderGroupForm = (settings) => {\r\n\r\n    const $eb = require(\"eventBinder\")\r\n    const n = document.querySelector(\"#numberOfBookings\").value\r\n    const roomTypes = $dm.getRoomTypes(settings)\r\n    const form = createForm(n, roomTypes)\r\n    $make.childless(document.querySelector(\".groupCalc__formContainer\"))\r\n    const groupCalc = document.querySelector(\".groupCalc__formContainer\")\r\n    const button    = $make.el(\"button\")\r\n    button.setAttribute(\"class\", \"groupCalc__calculate\")\r\n    button.appendChild($make.txt(\"Calculate\"))\r\n    form.appendChild(button)\r\n    groupCalc.appendChild(form)\r\n    $eb.groupFormEvent(button, form)\r\n  }\r\n\r\n\r\n  const renderGroupPrices = (prices) => {\r\n\r\n    let container = document.querySelector(\".groupCalc__formContainer\")\r\n    $make.childless(container)\r\n    const $dm = require(\"dataManager\")\r\n    prices.forEach(booking => {\r\n      const data = $dm.objectToArrayWithHeaders(booking)    \r\n      const table = $make.tableFromArray(data.reverse())\r\n      let container = document.querySelector(\".groupCalc__formContainer\")\r\n      container = document.querySelector(\".groupCalc__formContainer\")\r\n      container.appendChild(table)\r\n    })\r\n  }\r\n\r\n  const renderFlatObjectFromDB = (object, objectName, className) => {\r\n    console.log(\"This is coming \" + objectName)\r\n    const container   = $make.el(\"div\")\r\n    const heading     = $make.el(\"h2\")\r\n    const headingText = $make.txt(objectName)\r\n\r\n    container.appendChild(heading)\r\n    heading.appendChild(headingText)\r\n\r\n    for(let key in object) {\r\n      let text = key\r\n      text += \": \"\r\n      text += object[key]\r\n\r\n      const textNode = $make.txt(text)\r\n      const input    = $make.el(\"input\")\r\n      const div      = $make.el(\"div\")\r\n      div.appendChild(textNode)\r\n      div.appendChild(input)\r\n      input.dataset.key = key\r\n      container.appendChild(div)\r\n    }\r\n\r\n    const button = $make.button(\"Upload changes\")\r\n    container.appendChild(button)\r\n    const $eb = require(\"eventBinder\")\r\n\r\n    $eb.bindClickEvent(button, () => {\r\n      const inputs = Array.from(container.querySelectorAll(\"input\"))\r\n      inputs.forEach(input => {\r\n        const key   = input.dataset.key\r\n        const value = parseInt(input.value)\r\n        console.log(value)\r\n        if(value)\r\n          object[key] = value\r\n      })\r\n      const $db = require(\"database\")\r\n      let settings = $db.get(\"settings\")\r\n      console.log(object)\r\n      settings[objectName] = object\r\n      $db.uploadSettings(settings)\r\n    })\r\n\r\n    const close = $make.button(\"Close\", () => {\r\n      $make.childless(container)\r\n    })\r\n\r\n    container.appendChild(close)\r\n\r\n    return container\r\n  }\r\n\r\n  const roomTypeEditor = (object, objectName) => {\r\n    const container = $make.el(\"div\")\r\n    const heading = $make.heading(objectName)\r\n\r\n    for(let key in object) {\r\n      const ul = $make.el(\"ul\")\r\n\r\n      object[key].forEach(item => {\r\n        $make.roomTypeListItem(item, ul)\r\n      })\r\n      const input = $make.input(\"text\")\r\n      const btn   = $make.button(\"Add to list\", () => {\r\n        $make.roomTypeListItem(input.value, ul)\r\n      })\r\n      container.appendChild($make.heading(key))\r\n      container.appendChild(ul)\r\n    }\r\n\r\n    const btn = $make.button(\"Upload settings\", () => {\r\n      $db.uploadRoomTypes(container)\r\n    })\r\n\r\n    return container\r\n  }\r\n\r\n  const contractEditor = (object, objectName) => {\r\n    const container = $make.el(\"div\")\r\n    const heading = $make.el(\"h2\")\r\n    heading.appendChild($make.txt(objectName))\r\n    container.appendChild(heading)\r\n\r\n    for(let key in object) {\r\n      container.appendChild(renderFlatObjectFromDB(object[key], key))\r\n    }\r\n    return container\r\n  }\r\n\r\n  const displaySettingsFor = key => {\r\n    console.log(key)\r\n    const settings = $db.get(\"settings\")\r\n    let editor;\r\n\r\n    switch(key) {\r\n      case \"retailContract\":  editor = contractEditor(settings[key], key); break;\r\n      case \"roomTypes\":       editor = roomTypeEditor(settings[key], key); break;\r\n      default:                editor = renderFlatObjectFromDB(settings[key], key)\r\n    }\r\n\r\n    console.log(editor)\r\n\r\n    const settingsWindow = document.querySelector(\".settingsWindow\")\r\n    settingsWindow.appendChild(editor)\r\n  }\r\n\r\n\r\n\r\n  return {\r\n    getAvailabilityTable: getAvailabilityTable,\r\n    createSubForm: createSubForm,\r\n    createForm: createForm,\r\n    renderGroupForm: renderGroupForm,\r\n    renderRates: renderRates,\r\n    renderAvailability: renderAvailability,\r\n    renderGroupPrices: renderGroupPrices,\r\n    renderFlatObjectFromDB: renderFlatObjectFromDB,\r\n    displaySettingsFor: displaySettingsFor,\r\n  }\r\n})"]}