{"version":3,"sources":["../appES6/renderES5.js"],"names":[],"mappings":"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","file":"render.js","sourcesContent":["define((require) => {\r\n  const $make = require(\"make\")\r\n  const $dm   = require(\"dataManager\")\r\n\r\n\r\n  const availability = (availabilities) => {\r\n\r\n    const table           = getAvailabilityTable(availabilities)\r\n    const availabilityDiv = document.querySelector(\".channelAvailability\")\r\n    availabilityDiv.appendChild(table)\r\n  }\r\n\r\n  const tableFromArray = (table, headers) => $make.tableFromArray(table, headers)\r\n\r\n  const preFormButton = () => {\r\n    const settings = $dm.get(\"settings\")\r\n    return $make.button(\"Make Form\", () => { groupForm(settings) }, \"groupCalc__preFormButton\")\r\n  }\r\n\r\n  const rates = (rates) => {\r\n\r\n    const tableHeaders = [\"date\", \"rates\", \"availbilities\"]\r\n    const rateTable    = $make.tableFromArray(rates, tableHeaders)\r\n    return rateTable\r\n  }\r\n\r\n  const getAvailabilityTable = (availabilities) => {\r\n    const array = $dm.availabilityToTableFormat(availabilities)\r\n    return $make.tableFromArray(array)\r\n  }\r\n\r\n  const appendInput = (div, text, inputType, inputName, defaultValue) => {\r\n\r\n    const input    = $make.input(inputType, defaultValue, null)\r\n    const br       = $make.el(\"br\")\r\n    const textNode = $make.txt(text)\r\n\r\n    div.appendChild(textNode)\r\n    div.appendChild(input)\r\n    div.appendChild(br)\r\n  }\r\n\r\n  const createSubForm = (index, roomTypes) => {\r\n\r\n    const superDiv   = $make.el(\"div\")\r\n    superDiv.setAttribute(\"class\", \"groupBooking booking\" + index)\r\n    appendInput(superDiv, \"date for booking \" + index, \"date\", \"date\" + index, \"2018-1-1\")\r\n    appendInput(superDiv, \"nights for booking \" + index, \"number\", \"nights\" + index, 1)\r\n    \r\n    for(let key in roomTypes) {\r\n      appendInput(\r\n        superDiv, \r\n        \"number of \" + roomTypes[key] + \" rooms\",\r\n        \"number\",\r\n        key + index,\r\n        1)\r\n    }\r\n\r\n    return superDiv\r\n  }\r\n\r\n  const createForm = (numberOfSubforms, roomTypes) => {\r\n\r\n    const form = $make.el(\"form\")\r\n    form.setAttribute(\"class\", \"groupCalc__form\")\r\n    for(let i = 1; i <= numberOfSubforms; i++) {\r\n      const div = createSubForm(i, roomTypes)\r\n      div.setAttribute(\"class\", \"groupCalc__booking\" + i)\r\n      form.appendChild(div)\r\n    }\r\n    return form\r\n  }\r\n\r\n\r\n  const groupFormEvent = (form) => {\r\n    const prices = $dm.getPricesFromForm(form)\r\n    groupPrices(prices)\r\n  }\r\n\r\n  const groupForm = (settings) => {\r\n\r\n    const n = document.querySelector(\"#numberOfBookings\").value\r\n    const roomTypes = $dm.getRoomTypes(settings)\r\n    const form = createForm(n, roomTypes)\r\n    $make.childless(document.querySelector(\".groupCalc__formContainer\"))\r\n    const groupCalc = document.querySelector(\".groupCalc__formContainer\")\r\n    const button    = $make.button(\"Calculate\", () => { groupFormEvent(form) } ,\"groupCalc__calculate\")\r\n    console.trace(\"here\")\r\n    form.appendChild(button)\r\n    groupCalc.appendChild(form)\r\n  }\r\n\r\n  const groupPrices = (prices) => {\r\n\r\n    let container = document.querySelector(\".groupCalc__formContainer\")\r\n    $make.childless(container)\r\n    const $dm = require(\"dataManager\")\r\n    prices.forEach(booking => {\r\n      const data = $dm.objectToArrayWithHeaders(booking)    \r\n      const table = $make.tableFromArray(data.reverse())\r\n      let container = document.querySelector(\".groupCalc__formContainer\")\r\n      container = document.querySelector(\".groupCalc__formContainer\")\r\n      container.appendChild(table)\r\n    })\r\n  }\r\n\r\n\r\n  const flatObjectFromDB = (object, objectName, className, sendSettings) => {\r\n    console.log(\"This is coming \" + objectName)\r\n    const container   = $make.el(\"div\", \"editor\")\r\n    const heading     = $make.el(\"h2\", \"editor__heading\")\r\n    const headingText = $make.txt(objectName)\r\n\r\n    container.appendChild(heading)\r\n    heading.appendChild(headingText)\r\n\r\n    for(let key in object) {\r\n      let text = key\r\n      text += \": \"\r\n      text += object[key]\r\n\r\n      const textNode = $make.txt(text)\r\n      const input    = $make.el(\"input\")\r\n      const div      = $make.el(\"div\", \"editor__item\")\r\n      div.appendChild(textNode)\r\n      div.appendChild(input)\r\n      input.dataset.key = key\r\n      container.appendChild(div)\r\n    }\r\n\r\n    const button = $make.button(\r\n      \"Upload changes\", \r\n      () => {\r\n        const inputs = Array.from(container.querySelectorAll(\"input\"))\r\n        inputs.forEach(input => {\r\n          \r\n          const key   = input.dataset.key\r\n\r\n          const value = parseInt(input.value)\r\n          console.log(value)\r\n          if(value)\r\n            object[key] = value\r\n        })\r\n        let settings = $dm.get(\"settings\")\r\n        console.log(object)\r\n        if(container.classList.contains(\"retailContract\"))\r\n          settings[\"retailContract\"][objectName] = object\r\n        else \r\n          settings[objectName] = object\r\n\r\n        $dm.uploadSettings(settings)\r\n      }, \r\n      \"settings__uploadButton\"\r\n    )\r\n\r\n    container.appendChild(button)\r\n\r\n    const close = $make.button(\"Close\", () => {\r\n      $make.childless(container)\r\n    })\r\n\r\n    container.appendChild(close)\r\n\r\n    return container\r\n  }\r\n\r\n  const roomTypeEditor = (object, objectName) => {\r\n    const container = $make.el(\"div\")\r\n    const heading = $make.heading(objectName)\r\n\r\n    for(let key in object) {\r\n      const ul = $make.el(\"ul\")\r\n      ul.dataset.roomTypeClass = key\r\n\r\n      object[key].forEach(item => {\r\n        const li = $make.roomTypeListItem(item)\r\n        ul.appendChild(li)\r\n      })\r\n      const input = $make.input(\"text\")\r\n      const btn   = $make.button(\"Add to list\", () => {\r\n        const li = $make.roomTypeListItem(input.value)\r\n        ul.appendChild(li)\r\n      })\r\n\r\n      ul.appendChild(input)\r\n      ul.appendChild(btn)\r\n\r\n      container.appendChild($make.heading(key))\r\n      container.appendChild(ul)\r\n    }\r\n\r\n    const btn = $make.button(\"Upload settings\", () => {\r\n      $dm.uploadRoomTypes(container)\r\n    })\r\n\r\n    container.appendChild(btn)\r\n\r\n    return container\r\n  }\r\n\r\n  const contractEditor = (object, objectName) => {\r\n    const container = $make.el(\"div\")\r\n    const heading = $make.el(\"h2\")\r\n    heading.appendChild($make.txt(objectName))\r\n    container.appendChild(heading)\r\n\r\n    for(let key in object) {\r\n      container.appendChild(flatObjectFromDB(object[key], key, \"retailContract\"))\r\n    }\r\n    return container\r\n  }\r\n\r\n  const displaySettingsFor = key => {\r\n    console.log(key)\r\n    const settings = $dm.get(\"settings\")\r\n    let editor;\r\n\r\n    switch(key) {\r\n      case \"retailContract\":  editor = contractEditor(settings[key], key); break;\r\n      case \"roomTypes\":       editor = roomTypeEditor(settings[key], key); break;\r\n      default:                editor = flatObjectFromDB(settings[key], key)\r\n    }\r\n\r\n    console.trace(editor)\r\n\r\n    const settingsWindow = document.querySelector(\".settings__window\")\r\n    settingsWindow.appendChild(editor)\r\n  }\r\n\r\n  const settingsWindow = () => {\r\n    const win = $make.draggableWindow(\"settings\")\r\n    const settingsList = $make.settingsList($dm.get(\"settings\"), displaySettingsFor)\r\n    document.querySelector(\"body\").appendChild(win)\r\n    win.classList.add(\"displayNone\")\r\n    win.appendChild(settingsList)\r\n    return win\r\n  }\r\n\r\n  return {\r\n    getAvailabilityTable: getAvailabilityTable,\r\n    createSubForm: createSubForm,\r\n    createForm: createForm,\r\n    groupForm: groupForm,\r\n    rates: rates,\r\n    availability: availability,\r\n    groupPrices: groupPrices,\r\n    flatObjectFromDB: flatObjectFromDB,\r\n    displaySettingsFor: displaySettingsFor,\r\n    tableFromArray: tableFromArray,\r\n    preFormButton: preFormButton,\r\n    settingsWindow: settingsWindow,\r\n\r\n  }\r\n})"]}