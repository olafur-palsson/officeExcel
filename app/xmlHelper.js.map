{"version":3,"sources":["../appES6/xmlHelperES5.js"],"names":[],"mappings":"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","file":"xmlHelper.js","sourcesContent":["define(require => {\r\n  const $req = require(\"request\")\r\n  const $alg = require(\"algorithm\")\r\n  const $render = require(\"render\")\r\n\r\n  const stringifyXML = xml => {\r\n    const strigifier = new XMLSerializer()\r\n    return strigifier.serializeToString(xml)\r\n  }\r\n\r\n  const xmlToTable = xmlDocument => {\r\n    const $dh  = require(\"dataHelper\")\r\n    console.log(\"here\")\r\n    const settings = $dh.getSettings()\r\n    console.log(\"and here\")\r\n    const availability = getAvailabilityObjectsFromSettingsArray(xmlDocument, settings.roomTypes)\r\n    console.log(availability)\r\n    const rates        = $alg.getRates(availability)\r\n    $render.renderRates(rates)\r\n    $render.renderAvailability(availability)\r\n  }\r\n\r\n  const getAndStoreXML = (url, callback) => {\r\n    console.log(callback)\r\n    $req.fromURL(url, \"DOM\").then(xmlDocument => {\r\n      const xmlString = stringifyXML(xmlDocument)\r\n      window.localStorage.setItem(\"rawXML\", xmlString)\r\n      console.log(\"uhteoanhue\")\r\n      xmlToTable(xmlDocument)\r\n      //callback()\r\n    })\r\n  }\r\n\r\n  const getInventoryFromID = (xml, inventoryID) => {\r\n    const inventory = xml.getElementsByTagName(\"inventoryItem\")\r\n      let returnItem = false\r\n      Array.from(inventory).forEach(item => {\r\n        const ID = item.getAttribute(\"inventoryCode\")\r\n        if(ID == inventoryID) returnItem = item\r\n      })\r\n        \r\n      if(!returnItem) alert(\"Error getting Inventory by ID: \" + inventoryID)\r\n      else return returnItem\r\n  }\r\n\r\n  const getAvailabilityObjectsFromSettingsArray = (xml, objectWithArraysOfRoomTypes) => {\r\n    console.log(xml)\r\n    let returnObject = {}\r\n    let prototypeWithDates = {}\r\n    for(let roomClass in objectWithArraysOfRoomTypes) {\r\n      const array = objectWithArraysOfRoomTypes[roomClass]\r\n      if(array.length == 0) {\r\n        alert(\"roomClass was empty\")\r\n        break;\r\n      }\r\n      const inventory = Array.from(getInventoryFromID(xml, array[0]).getElementsByTagName(\"day\"))\r\n      inventory.forEach(day => {\r\n        const date = day.getAttribute(\"date\")\r\n        prototypeWithDates[date] = [0, 0]\r\n      })\r\n    }\r\n\r\n    for(let roomClass in objectWithArraysOfRoomTypes) {\r\n      console.log(roomClass)\r\n      returnObject[roomClass] = {}\r\n      for(let key in prototypeWithDates)\r\n        returnObject[roomClass][key] = [0, 0]\r\n\r\n      objectWithArraysOfRoomTypes[roomClass].forEach(roomType => {\r\n        const inventory = Array.from(getInventoryFromID(xml, roomType).getElementsByTagName(\"day\"))\r\n        inventory.forEach(day => {\r\n          const date         = day.getAttribute(\"date\")\r\n          const availability = day.getAttribute(\"availability\")\r\n          const currentRate  = day.getAttribute(\"rate\")\r\n          returnObject[roomClass][date][1] = currentRate\r\n          returnObject[roomClass][date][0] += parseInt(availability)\r\n        })\r\n      })\r\n    }\r\n    return returnObject\r\n  }\r\n\r\n\r\n  return {\r\n    getInventory: getInventoryFromID,\r\n    getAvailabilityObjects: getAvailabilityObjectsFromSettingsArray,\r\n    getAndStoreXML: getAndStoreXML,\r\n    stringifyXML: stringifyXML\r\n  }\r\n})"]}